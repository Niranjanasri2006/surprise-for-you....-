<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Dear Eruma ‚ù§Ô∏è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { background: #fff0f3; overflow: hidden; font-family: 'Poppins', sans-serif; height: 100vh; width: 100vw; margin: 0; }
        .overlay { position: fixed; inset: 0; background: #fff0f3; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .chat-bubble { display: none; max-width: 80%; padding: 12px 18px; border-radius: 20px; margin-bottom: 12px; align-items: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05); background: white; border: 1px solid rgba(0,0,0,0.05); }
        .chat-bubble img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
        
        #bannerKodi { position: fixed; top: 45%; left: 100%; z-index: 1000; display: none; }
        .flag-wrapper { position: relative; background: white; padding: 20px 60px; border-top: 5px solid #ff4d6d; border-bottom: 5px solid #ff4d6d; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .flag-wrapper::before, .flag-wrapper::after { content: ''; position: absolute; top: -5px; width: 45px; height: calc(100% + 10px); background: #ff4d6d; z-index: -1; }
        .flag-wrapper::before { left: -25px; clip-path: polygon(100% 0, 0 50%, 100% 100%); }
        .flag-wrapper::after { right: -25px; clip-path: polygon(0 0, 100% 50%, 0 100%); }
        .inner-v { position: absolute; top: 0; width: 42px; height: 100%; background: white; z-index: 1; }
        .v-left { left: -22px; clip-path: polygon(100% 0, 12% 50%, 100% 100%); }
        .v-right { right: -22px; clip-path: polygon(0 0, 88% 50%, 0 100%); }
        .banner-text { font-size: 2.2rem; font-weight: bold; color: #d63384; white-space: nowrap; }
        @keyframes slideAcross { 0% { left: 100%; } 100% { left: -180%; } }

        .container { padding: 40px; border-radius: 40px; width: 90%; max-width: 420px; text-align: center; position: relative; z-index: 100; display: none; background: #ffffff; border: 3px solid #ffccd5; box-shadow: 0 25px 50px -12px rgba(255, 77, 109, 0.25); }
        .special-name { font-family: 'Dancing Script', cursive; color: #ff4d6d; font-size: 3.5rem; display: block; margin-top: 10px; }
        #noBtn { position: absolute; transition: 0.15s ease; z-index: 100; touch-action: none; }
    </style>
</head>
<body id="mainBody" class="flex items-center justify-center">

    <img src="bubu2.gif" style="display:none;">

    <div id="chatOverlay" class="overlay p-6">
        <div class="mb-10 text-center"><h1 class="text-3xl font-bold text-[#ff4d6d]">Personal Chat ‚ú®</h1><p id="status" class="text-sm text-gray-400">typing...</p></div>
        <div class="flex flex-col w-full max-w-sm" id="chatContainer">
            <div class="chat-bubble" id="chat1" style="align-self: flex-start;"><img src="girl.png" class="mr-3"><span id="text1"></span></div>
            <div class="chat-bubble" id="chat2" style="align-self: flex-end; background: #d1f2ff;"><span id="text2"></span><img src="boy.png" class="ml-3"></div>
            <div class="chat-bubble" id="chat3" style="align-self: flex-start;"><img src="girl.png" class="mr-3"><span id="text3"></span></div>
            <div class="chat-bubble" id="chat4" style="align-self: flex-end; background: #d1f2ff;"><span id="text4"></span><img src="boy.png" class="ml-3"></div>
        </div>
        <button id="chatReadyBtn" class="hidden bg-[#ff4d6d] text-white px-12 py-3 rounded-full font-bold mt-10 shadow-lg">Open My Surprise üéÅ</button>
    </div>

    <div id="envelopeOverlay" class="overlay" style="display: none;">
        <div class="text-[100px] cursor-pointer animate-bounce">üíå</div>
        <p class="mt-4 font-bold text-[#d63384] text-xl">Oru letter vandhuruku!</p>
    </div>

    <div id="bannerKodi">
        <div class="flag-wrapper"><div class="inner-v v-left"></div><span class="banner-text">‚ú® Happy Valentine's Day Rajubhai ‚ù§Ô∏èüíãü´Ç‚ú®</span><div class="inner-v v-right"></div></div>
    </div>

    <audio id="bgMusic" loop><source src="song.mp3" type="audio/mpeg"></audio>

    <div class="container" id="box">
        <img id="gif" class="w-64 h-64 mx-auto rounded-3xl object-cover mb-6 hidden" src="bubu1.gif">
        <div id="messageArea">
            <h1 id="mainText" class="text-2xl font-bold text-[#d63384]">Will you be my Valentine, <br>My Dear Eruma? ‚ù§Ô∏è</h1>
        </div>
        <div class="mt-12 h-32 flex justify-center items-center gap-6" id="btnGroup">
            <button id="yesBtn" class="bg-green-500 text-white px-12 py-3 rounded-full text-xl font-bold shadow-lg">Yes</button>
            <button id="noBtn" class="bg-red-500 text-white px-8 py-2 rounded-full font-bold">No</button>
        </div>
    </div>

    <script>
        const chatReadyBtn = document.getElementById('chatReadyBtn');
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const banner = document.getElementById('bannerKodi');
        const gif = document.getElementById('gif');
        const mainText = document.getElementById('mainText');
        const box = document.getElementById('box');

        const msgs = [
            { id: "chat1", tid: "text1", txt: "Hey Eruma! üòò" },
            { id: "chat2", tid: "text2", txt: "Hey Monkey sollu..!" },
            { id: "chat3", tid: "text3", txt: "Unaku oru surprise üòâ" },
            { id: "chat4", tid: "text4", txt: "Enna surprise? Seekram sollu! üòç" }
        ];

        function startType(i) {
            if (i < msgs.length) {
                document.getElementById(msgs[i].id).style.display = 'flex';
                let charIdx = 0; let target = document.getElementById(msgs[i].tid);
                let interval = setInterval(() => {
                    target.innerHTML += msgs[i].txt[charIdx]; charIdx++;
                    if (charIdx >= msgs[i].txt.length) { 
                        clearInterval(interval); 
                        setTimeout(() => startType(i + 1), 800); 
                    }
                }, 60);
            } else { 
                chatReadyBtn.classList.remove('hidden'); 
                document.getElementById('status').innerHTML = "Online"; 
            }
        }

        window.onload = () => startType(0);

        chatReadyBtn.onclick = () => {
            document.getElementById('chatOverlay').style.display = 'none';
            document.getElementById('envelopeOverlay').style.display = 'flex';
        };

        document.getElementById('envelopeOverlay').onclick = () => {
            document.getElementById('envelopeOverlay').style.display = 'none';
            box.style.display = 'block';
            document.getElementById('bgMusic').play().catch(e => console.log("Audio play needs interaction"));
        };

        let noCount = 0;

        function moveButton() {
            noCount++;
            gif.classList.remove('hidden');

            // Screen boundaries for mobile
            const padding = 20;
            const maxX = window.innerWidth - noBtn.offsetWidth - padding;
            const maxY = window.innerHeight - noBtn.offsetHeight - padding;
            
            const newX = Math.min(maxX, Math.max(padding, Math.random() * maxX));
            const newY = Math.min(maxY, Math.max(padding, Math.random() * maxY));
            
            noBtn.style.position = "fixed";
            noBtn.style.left = newX + "px";
            noBtn.style.top = newY + "px";

            if(noCount === 1) {
                gif.src = "bubu1.gif"; 
                mainText.innerHTML = "Ennadu No-va?? üò≤";
            } else if(noCount === 2) {
                gif.src = "bubu2.gif"; 
                mainText.innerHTML = "Yosi My Dear Eruma... üò≠ <br>Please Yes sollu!";
            } else {
                gif.src = "slap.gif"; 
                mainText.innerHTML = "Anba sonna kekka matta, <br>chappunu ore adithan! üëãüí¢";
                noBtn.style.display = "none"; 
            }
        }

        // Support for both desktop and mobile touch
        noBtn.onmouseover = moveButton;
        noBtn.ontouchstart = (e) => {
            e.preventDefault();
            moveButton();
        };
        noBtn.onclick = (e) => {
            e.preventDefault();
            moveButton();
        };

        yesBtn.onclick = () => {
            box.style.background = "transparent";
            box.style.boxShadow = "none";
            box.style.border = "none";
            document.getElementById('messageArea').innerHTML = `<h1 class="text-4xl font-bold text-white drop-shadow-lg">I knew it Eruma! ‚ù§Ô∏è</h1><span class="special-name">Razz ‚àû Srizz</span>`;
            gif.src = "happy.gif";
            document.getElementById('btnGroup').style.display = 'none';
            document.body.style.background = "url('bg.gif') center/cover";
            confetti({ particleCount: 200, spread: 80, origin: { y: 0.6 } });
            setTimeout(() => { 
                banner.style.display = 'block'; 
                banner.style.animation = "slideAcross 10s linear forwards"; 
            }, 1000);
        };
    </script>
</body>
</html>
